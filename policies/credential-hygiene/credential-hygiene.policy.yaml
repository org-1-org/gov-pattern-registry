kind: policy

metadata:
  name: credential-hygiene
  version: "0.1.0"
  description: "Enforceable credential handling constraints (no secrets in repo, predictable token caches, no secret logging)."
  status: active

scope:
  level: repo
  domain: auth

references:
  contracts:
    - credential-provider@0.1.0

rules:
  - id: CRED-001
    rule: "No secrets in repository"
    severity: error
    checkable: true
    validation:
      - "No committed credential bundles (tokens, api keys, passwords)."
      - "Credential artifacts and token caches are gitignored."

  - id: CRED-002
    rule: "Credentials loaded via abstraction"
    severity: error
    checkable: true
    validation:
      - "Adapters do not read secrets from environment or files directly."
      - "Credential-provider is the only credential loading boundary."

  - id: CRED-003
    rule: "Token caches are local-only"
    severity: error
    checkable: true
    validation:
      - "Token cache paths are predictable and documented."
      - "Token cache creation is lazy (not at import time)."

  - id: CRED-004
    rule: "No secrets in logs"
    severity: error
    checkable: false
    notes: "Requires code review or runtime detection."
